<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Clonal Analysis Utilities in APackOfTheClones â€¢ APackOfTheClones</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Clonal Analysis Utilities in APackOfTheClones">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-TSDH5XEN3S"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TSDH5XEN3S');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">APackOfTheClones</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/APackOfTheClones-install.html">Install</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/APackOfTheClones.html">Get started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/APackOfTheClones-runs.html">Storing and Fine-Tuning APackOfTheClones Runs</a></li>
    <li><a class="dropdown-item" href="../articles/APackOfTheClones-shared.html">Working With Clonotypes Shared Across Clusters</a></li>
    <li><a class="dropdown-item" href="../articles/APackOfTheClones-utils.html">Clonal Analysis Utilities in APackOfTheClones</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-archive" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Archive</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-archive">
<li><a class="dropdown-item" href="../articles/archive/v0-main.html">v0.1.x main vignette</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Qile0317/APackOfTheClones/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Clonal Analysis Utilities in APackOfTheClones</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Qile0317/APackOfTheClones/blob/dev/vignettes/APackOfTheClones-utils.Rmd" class="external-link"><code>vignettes/APackOfTheClones-utils.Rmd</code></a></small>
      <div class="d-none name"><code>APackOfTheClones-utils.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Here is a small collection of potentially useful functions to modify
clonal expansion plots and work with clonal data that may be
relevant.</p>
</div>
<div class="section level2">
<h2 id="seperately-modifying-the-clone-size-legend">Seperately Modifying the Clone Size Legend<a class="anchor" aria-label="anchor" href="#seperately-modifying-the-clone-size-legend"></a>
</h2>
<p>The <code>removeLegend</code> and <code>overlayLegend</code>
functions both takes in an existing APackOfTheClones plot to either
remove or change its position/aesthetics on the plot by directly
modifying the ggplot object.</p>
</div>
<div class="section level2">
<h2 id="getting-clone-sizes-as-a-list">Getting Clone Sizes as a List<a class="anchor" aria-label="anchor" href="#getting-clone-sizes-as-a-list"></a>
</h2>
<p><code>scRepertoire</code> counts and store the clone sizes in a
column of the seurat object metadata. The <code>countCloneSizes</code>
function returns this information in a list where each element is a
table object corresponding to the clonotype frequencies for that
cluster, and a cluster with no clonotypes will have an empty table at
its index. Alternatively, it can also get the aggregate clone sizes. It
also allows for the same filtering arguments as seen in
<code><a href="../reference/RunAPOTC.html">RunAPOTC()</a></code> and <code><a href="../reference/vizAPOTC.html">vizAPOTC()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="getting-clonotypes-common-across-seurat-clusters">Getting Clonotypes Common Across Seurat Clusters<a class="anchor" aria-label="anchor" href="#getting-clonotypes-common-across-seurat-clusters"></a>
</h2>
<p>The <code>getSharedClones</code> is a convenience function does this
with the subsetting arguments, and returns the shared clonotypes as a
named list where the names are the clonotypes and the elements are
numeric vectors where each number is one of the clusters that the
clonotype name at its index correspond to. A combined seurat object is
loaded with the variable name <code>pbmc</code>::</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getSharedClones.html">getSharedClones</a></span><span class="op">(</span><span class="va">pbmc</span>, clonecall <span class="op">=</span> <span class="st">"aa"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $CASLSGSARQLTF_CASSPTVAGEQFF</span></span>
<span><span class="co">#&gt; [1] 5 9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $CVVSDFGNEKLTF_CASSLGSGGTGNEQFF</span></span>
<span><span class="co">#&gt; [1] 3 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $CVVSDNTGGFKTIF_CASSVRRERANTGELFF</span></span>
<span><span class="co">#&gt; [1] 3 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`CAVGEKGYGGSQGNLIF_CASSFRPPGSPLHF;CASHGARGDGFCEKLFF`</span></span>
<span><span class="co">#&gt; [1] 3 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $CARKVRDSSYKLIF_CASSDSGYNEQFF</span></span>
<span><span class="co">#&gt; [1] 3 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $CASLSGSARQLTF_CASSSTVAGEQYF</span></span>
<span><span class="co">#&gt; [1] 4 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $CAVTFHYNTDKLIF_CASSQDRTGLDYEQYF</span></span>
<span><span class="co">#&gt; [1] 4 9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $CALSGSRDDKIIF_NA</span></span>
<span><span class="co">#&gt; [1]  3 13</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $CAELNQAGTALIF_CASSQAPFSTSGELFF</span></span>
<span><span class="co">#&gt; [1] 3 5 9</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="getting-geometric-centroids-for-seurat-reductions">Getting Geometric Centroids For Seurat Reductions<a class="anchor" aria-label="anchor" href="#getting-geometric-centroids-for-seurat-reductions"></a>
</h2>
<p>The <code>getReductionCentroids</code> function is a shortcut for
getting the centroids as a list of numeric vectors of length 2 based on
some existing reduction in a seurat object.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/getReductionCentroids.html">getReductionCentroids</a></span><span class="op">(</span><span class="va">pbmc</span>, <span class="st">"umap"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1] -0.5520761  1.5759817</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1] -3.574884  3.540254</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; [1]  0.01797853 -2.58801380</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; [1]  2.286141 -3.725952</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[5]]</span></span>
<span><span class="co">#&gt; [1]  2.8382880 -0.4037927</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[6]]</span></span>
<span><span class="co">#&gt; [1] -4.0363226 -0.4305999</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="highlighting-specific-clonotypes">Highlighting Specific Clonotypes<a class="anchor" aria-label="anchor" href="#highlighting-specific-clonotypes"></a>
</h2>
<p>The <code>scRepertoire</code> package has a function
<code>scRepertoire::highlightClones</code> that highlights specific
points in the dimensional reduction plot that correspond to user
clonotype inputs and darkening everything else.
<code>showCloneHighlight</code> is the APackOfTheClones equivalent that
does so for each clonotype circle:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/showCloneHighlight.html">showCloneHighlight</a></span><span class="op">(</span></span>
<span>    <span class="va">apotc_ggplot</span>,</span>
<span>    <span class="va">clonotype</span>,</span>
<span>    color_each <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    default_color <span class="op">=</span> <span class="st">"#808080"</span>,</span>
<span>    scale_bg <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    fill_legend <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The function takes in a plot <code>apotc_ggplot</code> generated by
<code><a href="../reference/APOTCPlot.html">APOTCPlot()</a></code>/<code><a href="../reference/vizAPOTC.html">vizAPOTC()</a></code> and modifies its
underlying ggplot data to highlight/dim clones in
<code>clonotype</code>. Read the function level docs for more
information on how to customize the coloring of highlights with
<code>color_each</code> and <code>default_color</code>.</p>
<p>A potentially useful application is to inspect the shared
clonotypes:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create the APackOfTheClones plot</span></span>
<span><span class="va">apotc_plot</span> <span class="op">&lt;-</span> <span class="va">pbmc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/vizAPOTC.html">vizAPOTC</a></span><span class="op">(</span>clonecall <span class="op">=</span> <span class="st">"aa"</span>, show_labels <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get the shared clonotypes</span></span>
<span><span class="va">shared_clonotypes</span> <span class="op">&lt;-</span> <span class="va">pbmc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/getSharedClones.html">getSharedClones</a></span><span class="op">(</span>clonecall <span class="op">=</span> <span class="st">"aa"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># highlight the first 3 shared clones</span></span>
<span><span class="va">apotc_plot</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/showCloneHighlight.html">showCloneHighlight</a></span><span class="op">(</span><span class="va">shared_clonotypes</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="APackOfTheClones-utils_files/figure-html/highlight-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Qile Yang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
